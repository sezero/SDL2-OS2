# quick'n'dirty makefile for EMX
CC = gcc
AR = ar
RANLIB = ranlib

CFLAGS = -Zmt -Wall -O2 -fsigned-char
CFLAGS += -DHAVE_ALLOCA_H -DHAVE_FNMATCH -DHAVE_MKSTEMP -DHAVE_UMASK -DLIBXMP_CORE_PLAYER -DLIBXMP_NO_PROWIZARD -DLIBXMP_NO_DEPACKERS
CFLAGS += -Iinclude/libxmp-lite -Isrc

LIBNAME=xmp.a

OBJ=src/virtual.o src/format.o src/period.o src/player.o src/read_event.o src/dataio.o src/lfo.o src/scan.o src/control.o src/filter.o src/effects.o src/mixer.o src/mix_all.o src/load_helpers.o src/load.o src/hio.o src/smix.o src/memio.o src/loaders/common.o src/loaders/itsex.o src/loaders/sample.o src/loaders/xm_load.o src/loaders/mod_load.o src/loaders/s3m_load.o src/loaders/it_load.o

%.o: %.c
	$(CC) $(CFLAGS) -c -o $@ $<

.PHONY: clean distclean

all: $(LIBNAME)

$(LIBNAME): $(OBJ)
	$(AR) cru $(LIBNAME) $(OBJ)
	$(RANLIB) $(LIBNAME)

clean:
	-del src\*.o
	-del src\loaders\*.o
	-del *.o
distclean: clean
	-del $(LIBNAME)
